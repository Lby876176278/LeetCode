<script>
var integerReplacement = function(n) {
  var count = 0;
  while (n != 1) {
    if ((n & 1) == 0) {
      n >>>= 1;
    } else if (n == 3 || ((n >>> 1) & 1) == 0) {
      --n;
    } else {
      ++n;
    }
    ++count;
  }
  return count;
};

var integerReplacement = function(n) {
    var up, down, ans;
    if (n === 1) return 0;
    if (map[n.toString()]) {
        ans = map[n.toString()];
    }
    else {
        if (n % 2) {
            up = integerReplacement(n+1);
            down = integerReplacement(n-1);
            ans = (up > down) ? down + 1 : up + 1;
        } else {
            ans = integerReplacement(n/2) + 1;             
        }
        map[n.toString()] = ans;
    }
    return ans;
};

var map = {};
</script>